## Overview

This repo contains two different projects:

- ERC7579-based Social Recovery Recovery Module using AnonAadhaar in `src/anon-aadhaar`.
- ERC7579-based MultiFactor Social Recovery Module in `src/multi-factor`.

The codebases of both projects are largely based on [zkemail-recovery](https://github.com/zkemail/email-recovery).

## ERC7579 Recovery Module using AnonAaadhaar

This recovery module allows the owner of Aadhaar card ( Indian government-issued biometics card ) to anonymously prove their ownership and carry out social recovery as guardians.

These guardians are represented as uint256-type value that is the hash of a unique and private user identifier extracted from Aadhaar QR code, unlike zkEmail where guardians are essentially `EmailAuth.sol` and represented as theses contract addresses.

The way it works without guardians as neither EOAs nor contracts is to use relayers for broadcasting txs with AnonAadhaar proofs locally generated by guardians. Here, the hash of recovery action data including recovery payload, guardian addresses, nonce, etc, is bound to proofs, so relying on relayers doesn't pose any risks for manipulation to proof data as well as replay attacks / front-running.

## ERC7579 MultiFactor Recovery Module

This social recovery module allows guardians to choose any supported recovery validators. Currently, it supports `EcdsaValidator` and `AnonAadhaarValidator` as a PoC, but, in theory, it can also adapt many more validators that provide other signature validation schemes including zk proofs verification, such as passkey, Eddsa, zkEmail, Myna, etc...

### Anon Aadhaar

[Anon Aadhaar](https://github.com/anon-aadhaar/anon-aadhaar) is a zero-knowledge protocol that allows Aadhaar ID owners to prove their identity in a privacy-preserving way. It provides a set of tools to generate and verify proofs, authenticate users and verify proofs on-chain.

### ERC 7579

_[ERC-7579](https://erc7579.com/) outlines the minimally required interfaces and behavior for modular smart accounts and modules to ensure interoperability across implementations_

### Development

install packages:

```shell
yarn
```

compile contracts:

```shell
yarn/forge build
```

run test:

```shell
yarn/forge test
```

optionally, generate Aadhaar test data, nullifiers and proofs.
Then, you should replace the constant values in test/Inputs with the ones you get from this script.

```
ts-node script/ts/generateTestData.ts
ts-node script/ts/generateProofs.ts // or ts-node script/ts/generateProofsMultiFactor.ts
```
